{"queries":[{"id":"fos","compiledQueryString":"select name\nfrom rvvi.field_of_science","inputQueryString":"select name\nfrom rvvi.field_of_science","compiled":false,"inline":true},{"id":"articles_by_fos","compiledQueryString":"select fos.name, ac.year, SUM(aid_count) count\nfrom rvvi.field_of_science fos\njoin rvvi.article_core ac on fos.sid = ac.sid\nwhere fos.name LIKE '${inputs.fos.value}'\ngroup by fos.sid, fos.name, ac.year\norder by fos.sid","inputQueryString":"select fos.name, ac.year, SUM(aid_count) count\nfrom rvvi.field_of_science fos\njoin rvvi.article_core ac on fos.sid = ac.sid\nwhere fos.name LIKE '${inputs.fos.value}'\ngroup by fos.sid, fos.name, ac.year\norder by fos.sid","compiled":false,"inline":true},{"id":"ford","compiledQueryString":"select name\nfrom rvvi.field_ford","inputQueryString":"select name\nfrom rvvi.field_ford","compiled":false,"inline":true},{"id":"articles_by_institution","compiledQueryString":"select concat(rnk, '. ', i_name) as name, *\nfrom (\n  select *,\n    dense_rank() over (order by cnt desc) rnk\n  from (\n    select ac.iid, ac.i_name, ac.ranking, \n      sum(aid_count) ranking_cnt,\n      max(sum(case when ac.ranking = 'Decil' or ac.ranking = 'Q1' then aid_count end)) over (partition by ac.iid) cnt,\n    from rvvi.article_core ac\n    where ac.f_name LIKE '${inputs.ford_picker.value}'\n    group by ac.iid, ac.i_name, ac.ranking \n  ) t\n) t\nwhere rnk <= 15 and cnt is not null and cnt > 0\norder by rnk","inputQueryString":"select concat(rnk, '. ', i_name) as name, *\nfrom (\n  select *,\n    dense_rank() over (order by cnt desc) rnk\n  from (\n    select ac.iid, ac.i_name, ac.ranking, \n      sum(aid_count) ranking_cnt,\n      max(sum(case when ac.ranking = 'Decil' or ac.ranking = 'Q1' then aid_count end)) over (partition by ac.iid) cnt,\n    from rvvi.article_core ac\n    where ac.f_name LIKE '${inputs.ford_picker.value}'\n    group by ac.iid, ac.i_name, ac.ranking \n  ) t\n) t\nwhere rnk <= 15 and cnt is not null and cnt > 0\norder by rnk","compiled":false,"inline":true}]}